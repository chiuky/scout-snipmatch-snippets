{
  "uuid": "9e435165-81df-4490-9c79-301bb72dca60",
  "name": "updateChildEntity",
  "description": "update a child entity .",
  "extraSearchTerms": [],
  "tags": [],
  "code": "package com.oneleo.${componentname}.${entityname}.entity.service.internal.action;\r\n\r\nimport java.util.Arrays;\r\n\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\n\r\nimport com.ab.ah.scad.acl.dao.SearchCriteria;\r\nimport com.ab.ah.scad.acl.error.ApplicationFailureError;\r\nimport com.ab.ah.scad.acl.error.EntityNotFoundException;\r\nimport com.ab.ah.scad.acl.error.ExecuteException;\r\nimport com.ab.oneleo.common.commonsutil.error.ApplicationFailureErrorCodes;\r\nimport com.oneleo.${componentname}.${entityChildName}.entity.service.internal.converter.${entityChildName}TOTo${entityChildName}Converter;\r\nimport com.oneleo.${componentname}.${entityname}.entity.service.internal.converter.${entityParentName}To${entityChildName}TOConverter;\r\nimport com.oneleo.${componentname}.${entityname}.persistence.dao.${entityChildName}DAO;\r\nimport com.oneleo.${componentname}.${entityname}.persistence.model.jpa.${entityChildName};\r\nimport com.oneleo.${componentname}.${entityname}.persistence.model.jpa.defaultentity.fields.${entityParentName}Fields;\r\nimport com.oneleo.${componentname}.${entityChildName}.persistence.model.jpa.defaultentity.fields.${entityChildName}Fields;\r\n\r\n/**\r\n * @author aardizio Date : 12/07/2016 \r\n */\r\npublic class ${entityname}Update${entityChildName}Impl implements ${entityname}Update${entityChildName}Action {\r\n\r\n    /** The ${entityChildName}  dao. */\r\n    @Autowired\r\n    private ${entityChildName}DAO ${entityChildName};\r\n\r\n    /** The ${entityChildName} to ${entityChildName} to converter. */\r\n    @Autowired\r\n    private ${entityChildName}To${entityChildName}TOConverter ${entityChildName}To${entityChildName}TOConverter ;\r\n\r\n    /** The ${entityChildName}preference to to ${entityChildName} converter. */\r\n    @Autowired\r\n    private ${entityChildName}TOTo${entityChildName}Converter ${entityChildName}TOTo${entityChildName}Converter;\r\n\r\n\r\n   \r\n    @Override\r\n    public com.oneleo.${componentname}.to.${entityname}TO update${entityChildName}(com.oneleo.${componentname}.to.${entityChildName}TO ${entityChildName}TO) throws ExecuteException {\r\n\r\n        validateInput(${entityChildName}TO);\r\n        ${entityChildName} ${entityChildName}FromDB \u003d find(${entityChildName}TO);\r\n\r\n        if (${entityChildName}FromDB} !\u003d null) {\r\n            ${entityChildName} ${entityChildName}ToUpdate \u003d ${entityChildName}TOTo${entityChildName}Converter.convert(${entityChildName}TO);\r\n            ${entityChildName}ToUpdate.set${entityParentName}( ${entityChildName}FromDB.get${entityParentName}() );\r\n            ${entityChildName}ToUpdate.setId(${entityChildName}FromDB}.getId());\r\n            ${entityChildName}DAO.updateDomainEntity(${entityChildName}ToUpdate);\r\n            return ${entityChildName}To${entityChildName}TOConverter.convert(${entityChildName}ToUpdate);\r\n        } else {\r\n            throw new EntityNotFoundException(new Object[] { \"${entityParentName}Preference\", ${entityChildName}.get${entityParentName}BusinessKey()});\r\n        }\r\n    }\r\n\r\n\r\n\t\r\n    /**\r\n     * Find ${entityname}.\r\n     *\r\n     * @param \r\n     *            the ${entityChildName} preference\r\n     * @return the ${entityChildName} preference\r\n     */\r\n    private ${entityChildName} find${entityChildName}(com.oneleo.${componentname}.to.${entityname}TO ${entityname}TO) {\r\n        SearchCriteria ${searchCriteria:newName(com.ab.ah.scad.acl.dao.SearchCriteria)} \u003d new SearchCriteria();\r\n        if (${entityname}TO.get${entityParentName}BusinessKey().getId() !\u003d null) {\r\n            ${searchCriteria}.add(${entityChildName}Fields.PATIENT + SearchCriteria.DOT + ${entityParentName}Fields.ID, ${entityname}TO.get${entityParentName}BusinessKey().getId());\r\n        } else {\r\n            ${searchCriteria}.add(${entityParentName}PreferenceFields.PATIENT + SearchCriteria.DOT + ${entityParentName}Fields.CODE,${entityname}TO.get${entityParentName}BusinessKey().getCode());\r\n        }\r\n        return ${entityChildName}DAO.findDomainEntityBySearchCriteria(${searchCriteria});\r\n    }\r\n\r\n\r\n\t\r\n\t  /**\r\n     * Validate input.\r\n     *\r\n     * @param \r\n     *            the ${entityname} preference\r\n     * @throws ApplicationFailureError\r\n     *             the application failure error\r\n     */\r\n    private void validateInput(com.oneleo.${componentname}.to.${entityChildName}TO ${entityChildName}TO) throws ApplicationFailureError {\r\n        if (${entityChildName}TO \u003d\u003d null)\r\n            throw new ApplicationFailureError(ApplicationFailureErrorCodes.ERROR_NULL_OBJECT.getCode(), Arrays.asList(\"${entityChildName}TO\"));\r\n        if (${entityChildName}TO.get${entityParentName}BusinessKey() \u003d\u003d null)\r\n            throw new ApplicationFailureError(ApplicationFailureErrorCodes.ERROR_BUSINESS_KEY_MISSING.getCode(), Arrays.asList(\"${entityParentName}BusinessKey in ${entityChildName}TO\"));\r\n        if (${entityChildName}TO.get${entityParentName}BusinessKey().getCode() \u003d\u003d null \u0026\u0026 ${entityChildName}TO.get${entityParentName}BusinessKey().getId() \u003d\u003d null)\r\n            throw new ApplicationFailureError(ApplicationFailureErrorCodes.ERROR_BUSINESS_KEY_MISSING.getCode(), Arrays.asList(\"${entityParentName}BusinessKey\", \"update ${entityname} preference\"));\r\n    }\r\n\r\n}\r\n\r\n\r\n\t\r\n\r\n\t\r\n\r\n\r\n\r\n",
  "location": "JAVA",
  "filenameRestrictions": [],
  "dependencies": [
    {
      "groupId": "com.oneleo.patientdatamanagement",
      "artifactId": "patientdatamanagement-transfer-object",
      "version": "0.0.0"
    },
    {
      "groupId": "com.ab.ah.scad.acl",
      "artifactId": "acl-api",
      "version": "0.0.0"
    },
    {
      "groupId": "com.oneleo.patientdatamanagement.patient",
      "artifactId": "patient-entity-model",
      "version": "0.0.0"
    },
    {
      "groupId": "jre",
      "artifactId": "jre",
      "version": "0.0.0"
    },
    {
      "groupId": "com.oneleo.patientdatamanagement.patient",
      "artifactId": "patient-entity-api-impl",
      "version": "0.0.0"
    },
    {
      "groupId": "com.oneleo.patientdatamanagement.patient",
      "artifactId": "patient-entity-default-model",
      "version": "0.0.0"
    },
    {
      "groupId": "com.ab.oneleo.commons.eas",
      "artifactId": "commons-util",
      "version": "0.0.0"
    },
    {
      "groupId": "com.oneleo.patientdatamanagement.patient",
      "artifactId": "patient-repository-api",
      "version": "0.0.0"
    }
  ]
}